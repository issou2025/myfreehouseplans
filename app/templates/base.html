<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    
    {# SEO Meta Tags #}
    <title>{% block title %}{{ meta.title if meta else site_name }}{% endblock %}</title>
    <meta name="description" content="{% block meta_description %}{{ meta.description if meta else site_description }}{% endblock %}">
    {% block meta_keywords %}
    {% if meta and meta.keywords %}
    <meta name="keywords" content="{{ meta.keywords }}">
    {% elif site_description %}
    <meta name="keywords" content="{{ site_description }}">
    {% endif %}
    {% endblock %}
    <meta name="robots" content="index,follow">
    <link rel="canonical" href="{% block canonical %}{{ meta.canonical_url if meta else site_url }}{% endblock %}">
    
    {# Open Graph / Facebook #}
    <meta property="og:type" content="{% block og_type %}{{ meta.og_type if meta else 'website' }}{% endblock %}">
    <meta property="og:url" content="{% block og_url %}{{ meta.og_url if meta else site_url }}{% endblock %}">
    <meta property="og:title" content="{% block og_title %}{{ meta.og_title if meta else site_name }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ meta.og_description if meta else site_description }}{% endblock %}">
    <meta property="og:image" content="{% block og_image %}{{ meta.og_image if meta }}{% endblock %}">
    
    {# Twitter Card #}
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="{{ meta.og_url if meta else site_url }}">
    <meta name="twitter:title" content="{{ meta.og_title if meta else site_name }}">
    <meta name="twitter:description" content="{{ meta.og_description if meta else site_description }}">
    <meta name="twitter:image" content="{{ meta.og_image if meta }}">
    
    {# Favicon #}
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='images/favicon.ico') }}">
    
    {# Stylesheets #}
    <meta name="color-scheme" content="light dark">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    {% block extra_css %}{% endblock %}
    
    {# Structured Data #}
    {% block structured_data %}{% endblock %}
</head>
<body class="site-body">
    {# Header / Navigation #}
    <header class="site-header site-header--sticky" role="banner">
        <div class="shell site-header__inner">
            <a class="site-brand" href="{{ url_for('main.index') }}" aria-label="Return to homepage">
                <span class="site-brand__logo">üè† {{ site_name }}</span>
                <span class="site-brand__tagline">Beautiful homes, thoughtful design</span>
            </a>
            <button class="nav-toggle" aria-expanded="false" aria-controls="primary-navigation" aria-label="Toggle navigation">
                <span class="nav-toggle__icon"></span>
            </button>
            {% set current_endpoint = request.endpoint or '' %}
            <nav id="primary-navigation" class="nav" aria-label="Primary">
                <a class="nav-link {% if current_endpoint == 'main.index' %}is-active{% endif %}" href="{{ url_for('main.index') }}">Home</a>
                <a class="nav-link {% if current_endpoint in ['main.packs', 'main.pack_detail', 'main.plans_by_category'] %}is-active{% endif %}" href="{{ url_for('main.packs') }}">Plans</a>
                <a class="nav-link {% if current_endpoint == 'main.insight_page' %}is-active{% endif %}" href="{{ url_for('main.insight_page', slug='choose-family-plan') }}">Guides</a>
                <a class="nav-link {% if current_endpoint == 'main.favorites' %}is-active{% endif %}" href="{{ url_for('main.favorites') }}">Favorites</a>
                <a class="nav-link {% if current_endpoint in ['main.compare'] %}is-active{% endif %}" href="{{ url_for('main.compare') }}">Compare</a>
                <a class="nav-link {% if current_endpoint == 'main.about' %}is-active{% endif %}" href="{{ url_for('main.about') }}">About</a>
                <a class="nav-link {% if current_endpoint == 'main.contact' %}is-active{% endif %}" href="{{ url_for('main.contact') }}">Contact</a>
                {% if current_user.is_authenticated and current_user.is_admin %}
                    <a class="nav-link {% if current_endpoint and current_endpoint.startswith('admin.') %}is-active{% endif %}" href="{{ url_for('admin.dashboard') }}">Admin</a>
                    <a class="nav-link {% if current_endpoint == 'auth.profile' %}is-active{% endif %}" href="{{ url_for('auth.profile') }}">Account</a>
                    <a href="{{ url_for('auth.logout') }}" class="nav-link nav-link--muted">Logout</a>
                {% elif current_user.is_authenticated %}
                    <a href="{{ url_for('auth.logout') }}" class="nav-link nav-link--muted">Logout</a>
                {% endif %}
            </nav>
            <div class="site-header__cta" aria-label="Quick actions">
                <p class="site-header__note">üìû Here for you ¬∑ Mon‚ÄìFri</p>
                <div class="site-header__cta-buttons">
                    <a class="btn btn-ghost" href="{{ url_for('main.packs') }}">Explore plans</a>
                    <a class="btn btn-primary" href="{{ url_for('main.contact') }}">Get in touch</a>
                </div>
                <p class="site-header__help">Need help? <a href="{{ url_for('main.contact') }}">Send us a message</a></p>
            </div>
        </div>
    </header>
    <div class="nav-overlay" id="nav-overlay"></div>

    {# Flash Messages #}
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="flash-messages" role="status" aria-live="polite">
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">
                        <span class="alert__icon" aria-hidden="true">üôÇ</span>
                        <div class="alert__body">
                            <strong>{{ category|capitalize }}</strong>
                            <p>{{ message }}</p>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    {# Main Content #}
    <main id="main" role="main" class="page-shell">
        {% block content %}{% endblock %}
    </main>

    <div id="compareTray" class="compare-tray" aria-live="polite" hidden></div>

    {# Footer #}
    <footer class="site-footer">
        <div class="shell">
            <div class="footer-grid">
                <div class="footer-brand">
                    <h3 class="site-brand__logo">üè† {{ site_name }}</h3>
                    <p>We curate architectural plans that translate smoothly from PDF to construction. Every set is reviewed by architects and tested in real builds.</p>
                    <div class="footer-social">
                        <a href="https://wa.me/22796380877" target="_blank" rel="noopener" class="social-link" aria-label="WhatsApp">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
                            WhatsApp
                        </a>
                        <a href="mailto:entreprise2rc@gmail.com" class="social-link" aria-label="Email">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
                            Email Us
                        </a>
                    </div>
                </div>
                <div>
                    <h4>Explore</h4>
                    <ul>
                        <li><a href="{{ url_for('main.packs') }}">Plan catalog</a></li>
                        <li><a href="{{ url_for('main.favorites') }}">My favorites</a></li>
                        <li><a href="{{ url_for('main.compare') }}">Compare plans</a></li>
                        <li><a href="{{ url_for('main.insight_page', slug='choose-family-plan') }}">Design guides</a></li>
                    </ul>
                </div>
                <div>
                    <h4>Company</h4>
                    <ul>
                        <li><a href="{{ url_for('main.about') }}">About us</a></li>
                        <li><a href="{{ url_for('main.contact') }}">Contact & support</a></li>
                        <li><a href="{{ url_for('main.privacy') }}">Privacy policy</a></li>
                        <li><a href="{{ url_for('main.terms') }}">Terms of service</a></li>
                    </ul>
                </div>
                <div>
                    <h4>Get in Touch</h4>
                    <p><strong>Email:</strong> <a href="mailto:entreprise2rc@gmail.com">entreprise2rc@gmail.com</a></p>
                    <p><strong>Phone:</strong> <a href="tel:+22796380877">+227 96 38 08 77</a></p>
                    <p><strong>Location:</strong> Serving builders worldwide</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; {{ now.year if now else '2026' }} {{ site_name }}. All rights reserved. Built with care for builders everywhere.</p>
            </div>
        </div>
    </footer>

    {# JavaScript #}
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script>
        // Mobile navigation with slide-in menu
        (function(){
            const btn = document.querySelector('.nav-toggle');
            const nav = document.getElementById('primary-navigation');
            const overlay = document.getElementById('nav-overlay');
            
            if(!btn || !nav || !overlay) return;
            
            function openMenu() {
                nav.classList.add('is-open');
                overlay.classList.add('is-visible');
                btn.setAttribute('aria-expanded', 'true');
                document.body.style.overflow = 'hidden';
            }
            
            function closeMenu() {
                nav.classList.remove('is-open');
                overlay.classList.remove('is-visible');
                btn.setAttribute('aria-expanded', 'false');
                document.body.style.overflow = '';
            }
            
            // Toggle menu
            btn.addEventListener('click', function(){
                const isOpen = nav.classList.contains('is-open');
                if(isOpen) {
                    closeMenu();
                } else {
                    openMenu();
                }
            });
            
            // Close on overlay click
            overlay.addEventListener('click', closeMenu);
            
            // Close on nav link click (mobile)
            nav.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', function() {
                    if(window.innerWidth < 960) {
                        closeMenu();
                    }
                });
            });
            
            // Close on escape key
            document.addEventListener('keydown', function(e) {
                if(e.key === 'Escape' && nav.classList.contains('is-open')) {
                    closeMenu();
                }
            });
            
            // Handle window resize
            window.addEventListener('resize', function() {
                if(window.innerWidth >= 960) {
                    closeMenu();
                }
            });
        })();
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>
